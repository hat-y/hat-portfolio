<header class="taskbar" role="toolbar">
  <!-- Bot√≥n Home -->
  <div class="start-section">
    <button
      class="start-button btn-retro"
      [class.is-pressed]="showStartMenu()"
      (click)="toggleStartMenu()"
      type="button"
      aria-label="Home"
      [attr.aria-expanded]="showStartMenu()">
      <svg class="start-icon" width="14" height="14" viewBox="0 0 16 16">
        <rect x="1" y="1" width="6" height="6" fill="#f65314" stroke="#000" stroke-width="0.3"/>
        <rect x="8.5" y="1" width="6" height="6" fill="#7cbb00" stroke="#000" stroke-width="0.3"/>
        <rect x="1" y="8.5" width="6" height="6" fill="#00a1f1" stroke="#000" stroke-width="0.3"/>
        <rect x="8.5" y="8.5" width="6" height="6" fill="#ffbb00" stroke="#000" stroke-width="0.3"/>
      </svg>
      <span class="start-text">Start</span>
    </button>
  </div>

  <!-- Separador -->
  <div class="taskbar-separator"></div>

  <!-- Tabs/Ventanas abiertas -->
  <nav class="taskbar-tabs" role="tablist">
    @for (tab of openTabs(); track tab.id) {
      <button
        class="taskbar-tab btn-retro"
        [class.is-active]="tab.active"
        (click)="selectTab(tab.id)"
        type="button"
        role="tab"
        [attr.aria-selected]="tab.active"
        [attr.aria-controls]="tab.id + '-content'">
        <svg class="tab-icon" width="12" height="12" viewBox="0 0 16 16" fill="currentColor">
          <rect width="13" height="11" x="1.5" y="2.5" fill="none" stroke="currentColor" stroke-width="1"/>
          <rect width="13" height="2" x="1.5" y="2.5" fill="currentColor"/>
        </svg>
        <span class="tab-title">{{ tab.title }}</span>
      </button>
    }
  </nav>

  <!-- System Tray -->
  <div class="systray">
    <button class="systray-icon btn-retro" type="button" title="Network" aria-label="Network">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="display: block;">
        <path d="M2 4h2v2H2V4zm4 0h2v2H6V4zm4 0h2v2h-2V4zm-8 4h2v2H2V8zm4 0h2v2H6V8zm4 0h2v2h-2V8zm-8 4h2v2H2v-2zm4 0h2v2H6v-2zm4 0h2v2h-2v-2z"/>
      </svg>
    </button>
    <button class="systray-icon btn-retro" type="button" title="Volume" aria-label="Volume">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="display: block;">
        <path d="M5 5v6H3V5h2zm2 0 4-3v12l-4-3V5z"/>
      </svg>
    </button>
    <button
      class="systray-icon btn-retro"
      type="button"
      (click)="toggleTheme()"
      [attr.title]="themeService.themeMode() === 'dark' ? 'Switch to Light Theme' : themeService.themeMode() === 'light' ? 'Switch to Auto Theme' : 'Switch to Dark Theme'"
      [attr.aria-label]="getThemeAriaLabel()">
      @if (themeService.isDarkMode()) {
        <!-- Moon icon for dark theme -->
        <svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
      } @else {
        <!-- Sun icon for light theme -->
        <svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
      }
    </button>
    <button class="systray-icon btn-retro" type="button" title="Clock" aria-label="Clock">
      {{ currentTime() }}
    </button>
  </div>
</header>

<!-- Start Menu -->
@if (showStartMenu()) {
  <div
    class="start-menu"
    role="menu"
    aria-label="Applications menu">
    <div class="start-menu-header">Applications</div>
    <div class="start-menu-items" role="group" aria-label="Application list">
      @for (tab of tabs(); track tab.id) {
        <button
          class="start-menu-item"
          [class.is-open]="tab.open"
          [routerLink]="['/', tab.id]"
          (click)="toggleStartMenu()"
          type="button"
          role="menuitem"
          [attr.aria-label]="tab.title + (tab.open ? ' - Open' : ' - Closed')"
          [attr.aria-current]="tab.active ? 'page' : undefined">
          @if (tab.id === 'skills') {
            <span class="menu-item-icon" aria-hidden="true">üöÄ</span>
          } @else {
            <svg class="menu-item-icon" width="14" height="14" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
              <rect width="13" height="11" x="1.5" y="2.5" fill="none" stroke="currentColor" stroke-width="1"/>
              <rect width="13" height="2" x="1.5" y="2.5" fill="currentColor"/>
            </svg>
          }
          <span class="menu-item-title">{{ tab.title }}</span>
          @if (tab.open) {
            <span class="menu-item-status" aria-label="Currently open">‚óè</span>
          }
        </button>
      }
    </div>
  </div>
}
